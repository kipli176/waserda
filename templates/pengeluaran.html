{% extends "base.html" %}
{% block title %}Data Pengeluaran{% endblock %}
{% block content %}
<h2 class="text-lg font-semibold mb-2">Pengeluaran</h2>

<form method="post" class="bg-white p-4 border rounded mb-4">
    {% if item_edit %}
        <input type="hidden" name="mode" value="edit">
        <input type="hidden" name="id_pengeluaran" value="{{ item_edit[0] }}">
    {% endif %}

    <div class="mb-2">
        <label>Tanggal</label>
        <input type="date" name="tanggal" value="{{ item_edit[1] if item_edit else today }}"
               required class="w-full border p-2 rounded">
    </div>

    <div class="mb-2">
        <label>Kategori</label>
        <select name="kategori" required class="w-full border p-2 rounded">
            {% for k in kategori_list %}
                <option value="{{ k }}"
                  {% if item_edit and item_edit[2] == k %}selected{% endif %}>
                  {{ k }}
                </option>
            {% endfor %}
        </select>
    </div>

    <div class="mb-2">
        <label>Jumlah</label>
        <input name="jumlah" type="text" value="{{ item_edit[3] if item_edit else '' }}"
               required class="harga-format w-full border p-2 rounded">
    </div>

    <div class="mb-2">
        <label>Keterangan</label>
        <input name="keterangan" value="{{ item_edit[4] if item_edit else '' }}"
               class="w-full border p-2 rounded uppercase">
    </div>

    <button class="bg-blue-600 text-white px-4 py-2 rounded">
        {% if item_edit %}Simpan Perubahan{% else %}Tambah{% endif %}
    </button>
</form>

<table class="w-full text-sm border bg-white text-center">
    <tr class="bg-gray-100"> 
        <th class="border p-1">Tanggal</th>
        <th class="border p-1 text-right">Jumlah</th>
        <th class="border p-1">Keterangan</th>
    </tr>
    {% for row in rows %}
    <tr onclick="window.location='?edit={{ row[0] }}'" class="hover:bg-yellow-100 cursor-pointer"> 
        <td class="border p-1">{{ row[1] }}</td>
        <td class="border p-1 text-right">{{ row[3]|rupiah }}</td>
        <td class="border p-1">{{ row[4] }}</td>
    </tr>
    {% endfor %}
</table>

<a href="/" class="inline-block mt-4 text-blue-600">‚Üê Kembali ke Beranda</a>
{% endblock %}
{% block scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const keteranganInput = document.querySelector('input[name="keterangan"]');
    if (keteranganInput) {
      keteranganInput.addEventListener("input", function () {
        this.value = this.value.toUpperCase();
      });
    }
  });
</script>
{% endblock %} 